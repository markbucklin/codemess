%% 0622Ctx M2LH
clear all
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0622Ctx-M2LH\0622Ctx-M2LH-014DAT-BlueTraceROIs.mat')
B014 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0622Ctx-M2LH\0622Ctx-M2LH-034DAT-BlueTraceROIs.mat')
B034 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0622Ctx-M2LH\0622Ctx-M2LH-056DAT-40fps00001-BlueTraceROIs.mat')
B056 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0622Ctx-M2LH\0622Ctx-M2LH-084DAT-40fps00001-BlueTraceROIs.mat')
B084 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0622Ctx-M2LH\0622Ctx-M2LH-022DAT-BlueTraceROIs.mat')
B022 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0622Ctx-M2LH\0622Ctx-M2LH-046DAT-40fps00001-BlueTraceROIs.mat')
B046 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0622Ctx-M2LH\0622Ctx-M2LH-088DAT-40fps00001-BlueTraceROIs.mat')
B088 = traceOutBlue;
B={B014;B022;B034;B046;B056;B084;B088};
days={'B014','B022','B034','B046','B056','B084','B088'};
%% 0628Ctx M1RH

clear all
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628Ctx-M1RH\0628Ctx-M1RH-078DAT-60fps00001-BlueTraceROIs.mat')
B078=traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628Ctx-M1RH\0628Ctx-M1RH-050DAT-60fps00002-BlueTraceROIs.mat')
B050=traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628Ctx-M1RH\0628Ctx-M1RH-037DAT-60fps00001-BlueTraceROIs.mat')
B037=traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628Ctx-M1RH\0628Ctx-M1RH-029DAT-60fps00001-BlueTraceROIs.mat')
B029=traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628Ctx-M1RH\0628Ctx-M1RH-017DAT-BlueTraceROIs.mat')
B017=traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628Ctx-M1RH\0628Ctx-M1RH-042DAT-60fps00001-BlueTraceROIs.mat')
B042=traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628Ctx-M1RH\0628Ctx-M1RH-013DAT-BlueTraceROIs.mat')
B013=traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628Ctx-M1RH\0628Ctx-M1RH-082DAT-60fps00002-BlueTraceROIs.mat')
B082=traceOutBlue;
B={B013;B017;B029;B037;B042;B050;B078;B082};
days={'B013','B017','B029','B037','B042','B050','B078','B082'};
%% 0419GE M1RH
clear all
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419GE-M1RH\0419GE-M1RH-152DAT-40fps00001-BlueTraceROIs.mat')
B152 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419GE-M1RH\0419GE-M1RH-145DAT-40fps00001-BlueTraceROIs.mat')
B145 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419GE-M1RH\0419GE-M1RH-120DAT-40fps00001-BlueTraceROIs.mat')
B120 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419GE-M1RH\0419GE-M1RH-077DAT-BlueTraceROIs.mat')
B077 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419GE-M1RH\0419GE-M1RH-009DAT-BlueTraceROIs.mat')
B009 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419GE-M1RH\0419GE-M1RH-015DAT-BlueTraceROIs.mat')
B015 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419GE-M1RH\0419GE-M1RH-174DAT-40fps00001-BlueTraceROIs.mat')
B174 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419GE-M1RH\0419GE-M1RH-167DAT-40fps00001-BlueTraceROIs.mat')
B167 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419GE-M1RH\0419GE-M1RH-100DAT-40fps00001-BlueTraceROIs.mat')
B100 = traceOutBlue;
B={B009; B015; B077; B100; B120; B145; B152; B167; B174};
days={'B009','B015','B077','B100','B120','B145','B152','B167','B174'};

%%
clear all
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419Ctx-M1LH\0419Ctx-M1LH-152DAT-40fps00001-BlueTraceROIs.mat')
B152 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419Ctx-M1LH\0419Ctx-M1LH-145DAT-40fps00001-BlueTraceROIs.mat')
B145 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419Ctx-M1LH\0419Ctx-M1LH-120DAT-40fps00001-BlueTraceROIs.mat')
B120 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419Ctx-M1LH\0419Ctx-M1LH-077DAT-BlueTraceROIs.mat')
B077 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419Ctx-M1LH\0419Ctx-M1LH-015DAT-BlueTraceROIs.mat')
B015 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419Ctx-M1LH\0419Ctx-M1LH-009DAT-BlueTraceROIs.mat')
B009 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419Ctx-M1LH\0419Ctx-M1LH-100DAT-40fps-BlueTraceROIs.mat')
B100 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0419Ctx-M1LH\0419Ctx-M1LH-174DAT-40fps00001-BlueTraceROIs.mat')
B174 = traceOutBlue;
B={B009; B015; B077; B100; B120; B145; B152; B174};
days={'B009', 'B015','B077','B100','B120','B145','B152','B174'};


%%
clear all
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2LH\0628GE-M2LH-083DAT-60fps00002-BlueTraceROIs.mat')
B083 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2LH\0628GE-M2LH-013DAT-BlueTraceROIs.mat')
B013 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2LH\0628GE-M2LH-017DAT-BlueTraceROIs.mat')
B017 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2LH\0628GE-M2LH-29DAT-60fps00001-BlueTraceROIs.mat')
B029 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2LH\0628GE-M2LH-037DAT-60fps00001-BlueTraceROIs.mat')
B037 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2LH\0628GE-M2LH-042DAT-60fps00002-BlueTraceROIs.mat')
B042 = traceOutBlue;

B={B013; B017; B029; B037; B042; B083};
days={'B013', 'B017', 'B029', 'B037', 'B042', 'B083'};

%%
clear all
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0621GE-M2RH\0621GE-M2RH-015DAT-BlueTraceROIs.mat')
B015 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0621GE-M2RH\0621GE-M2RH-031DAT-BlueTraceROIs.mat')
B031 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0621GE-M2RH\0621GE-M2RH-023DAT-BlueTraceROIs.mat')
B023 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0621GE-M2RH\0621GE-M2RH-044DAT-40fps00001-BlueTraceROIs.mat')
B044 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0621GE-M2RH\0621GE-M2RH-057DAT-40fps00001-BlueTraceROIs.mat')
B057 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0621GE-M2RH\0621GE-M2RH-082DAT-40fps00003-BlueTraceROIs.mat')
B082 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0621GE-M2RH\0621GE-M2RH-089DAT-40fps00001-BlueTraceROIs.mat')
B089 = traceOutBlue;

B={B015; B023; B031; B044; B057; B082; B089};
days={'B015','B023','B031','B044','B057','B082','B089'};


%%

load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2RH\0628GE-M2RH-083DAT-60fps00001-BlueTraceROIs.mat')
B083 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2RH\0628GE-M2RH-014DAT-BlueTraceROIs.mat')
B014 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2RH\0628GE-M2RH-017DAT-BlueTraceROIs.mat')
B017 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2RH\0628GE-M2RH-029DAT-60fps00001-BlueTraceROIs.mat')
B029 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2RH\0628GE-M2RH-042DAT-60fps00001-BlueTraceROIs.mat')
B042 = traceOutBlue;
load('Z:\Data\susie\Temp Data-Processing\Traces\Archive\0628GE-M2RH\0628GE-M2RH-037DAT-60fps00002-BlueTraceROIs.mat')
B037 = traceOutBlue;

B={B014; B017; B029; B037; B042; B083};
days={'B014', 'B017', 'B029', 'B037', 'B042', 'B083'};


%% Violin plot
% close all
BlueQ={};
for n=1:size(B,1)
for m=1:size(B{n},2)
BlueQ{n,m} = trapz(B{n,1}(:,m));
end
end



for i=1:size(B,1)
    dat{1,i} = [BlueQ{i,:}]';
end

color = [27 153 139; 45 48 71; 255 253 130; 255 155 113; 232 72 85; 17 70 87; 44 23 91; 198 35 48; 197 14 87; 128 128 128]/255;
h1=figure
violinfig = violin(dat,'edgecolor','none','facecolor',color,'facealpha',0.5);
ax = gca;
set(ax,'XtickLabel',days)

fig1 = get(ax,'children');
clearvars dat

h3 = figure;
s1 = subplot(2,1,1);

copyobj(fig1,s1);
ax1 = gca;
set(ax1,'XtickLabel',["" ,days, ""])

close(h1)

s2 = subplot(2,1,2);
zlim([-100 inf])
xlim([500 5000])

view(-15,35)


% Cells over time
BlueQ={};
for n=1:size(B,1)
for m=1:size(B{n},1)
BlueQ{n,m} = trapz(B{n,1}(m,:));
end
end

for i=1:size(B,1)
    dat{1,i} = [BlueQ{i,:}]';
end
color = [27 153 139; 45 48 71; 255 253 130; 255 155 113; 232 72 85; 17 70 87; 44 23 91; 198 35 48; 197 14 87; 128 128 128]/255;

h2=figure
hold on
for m=1:size(B,1)
    plot([BlueQ{m,:}],'Color',[color(m,:) 0.5]);
end
hold off


hax = gca
sax = hax
max = axes
mfig = figure

max.Parent = mfig
for k=1:m
    mline(k) = line('XData',sax.Children(k).XData, ...
        'YData', ones(size(sax.Children(k).XData)).*(k-1)*-20, ...
        'ZData', sax.Children(k).YData, 'Color',[color(m-k+1,:) 0.5])
end



axis vis3d
zlim([-100 inf])
xlim([500 5000])

max.XGrid='on'
max.YTick = [];
set(gca,'Position', [0 0.1 1 0.7]);
view(-15,45)

fig2 = get(max,'children');
copyobj(fig2,s2);
close(h2,mfig)
ax2 = gca;
set(ax2,'XGrid','on','YTick',[(-20*m:20:20)],'YTickLabel',["" ,days, ""]);
view(-15,45)



%% Histogram

figure
subplot(1,7,1)
histogram([BlueQ{1,:}]);
subplot(1,7,2)
histogram([BlueQ{2,:}]);
subplot(1,7,3)
histogram([BlueQ{3,:}]);
subplot(1,7,4)
histogram([BlueQ{4,:}]);
subplot(1,7,5)
histogram([BlueQ{5,:}]);
subplot(1,7,6)
histogram([BlueQ{6,:}]);
subplot(1,7,7)
histogram([BlueQ{7,:}]);

histogram([BlueQ{:,:}]);



%% Violin plot - Firing Rate(not really ... rather how active during session

close all
BlueQ={};
for n=1:size(B,1)
for m=1:size(B{n},2)
BlueQ{n,m} = trapz(B{n,1}(:,m));
end
end

for i=1:size(B,1)
    dat{1,i} = [BlueQ{i,:}]';
end

color = [27 153 139; 45 48 71; 255 253 130; 255 155 113; 232 72 85; 17 70 87; 44 23 91; 198 35 48; 197 14 87; 128 128 128]/255;
h1=figure
violinfig = violin(dat,'edgecolor','none','facecolor',color,'facealpha',0.5);
ax = gca;
set(ax,'XtickLabel',days)

fig1 = get(ax,'children');
clearvars dat






